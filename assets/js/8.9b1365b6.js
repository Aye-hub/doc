(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{273:function(s,a,e){"use strict";e.r(a);var r=e(38),t=Object(r.a)({},function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"docker安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker安装","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker安装")]),s._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#三要素"}},[s._v("三要素")]),e("ul",[e("li",[e("a",{attrs:{href:"#镜像"}},[s._v("镜像")])]),e("li",[e("a",{attrs:{href:"#容器"}},[s._v("容器")])]),e("li",[e("a",{attrs:{href:"#仓库"}},[s._v("仓库")])])])]),e("li",[e("a",{attrs:{href:"#仓库-镜像-容器概念"}},[s._v("仓库/镜像/容器概念")])]),e("li",[e("a",{attrs:{href:"#docker安装并设置镜像加速"}},[s._v("Docker安装并设置镜像加速")]),e("ul",[e("li",[e("a",{attrs:{href:"#下载rpm包"}},[s._v("下载rpm包")])]),e("li",[e("a",{attrs:{href:"#安装防火墙"}},[s._v("安装防火墙")])]),e("li",[e("a",{attrs:{href:"#更新软件包"}},[s._v("更新软件包")])]),e("li",[e("a",{attrs:{href:"#安装rpm包"}},[s._v("安装rpm包")])]),e("li",[e("a",{attrs:{href:"#docker-镜像仓库加速配置"}},[s._v("Docker 镜像仓库加速配置")])])])])])]),e("p"),s._v(" "),e("h2",{attrs:{id:"三要素"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三要素","aria-hidden":"true"}},[s._v("#")]),s._v(" 三要素")]),s._v(" "),e("h3",{attrs:{id:"镜像"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#镜像","aria-hidden":"true"}},[s._v("#")]),s._v(" 镜像")]),s._v(" "),e("p",[e("code",[s._v("Docker")]),s._v("镜像（image）就是一个只读的模板，镜像可以用来创建"),e("code",[s._v("Docker")]),s._v("容器，一个镜像可以创建很多容器。")]),s._v(" "),e("h3",{attrs:{id:"容器"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#容器","aria-hidden":"true"}},[s._v("#")]),s._v(" 容器")]),s._v(" "),e("p",[e("code",[s._v("Docker")]),s._v("利用容器（Container）独立运行的一个或一组应用。容器是用镜像创建的运行实例。")]),s._v(" "),e("h3",{attrs:{id:"仓库"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#仓库","aria-hidden":"true"}},[s._v("#")]),s._v(" 仓库")]),s._v(" "),e("p",[s._v("仓库（Repository）是集中存放镜像文件的场所。")]),s._v(" "),e("h2",{attrs:{id:"仓库-镜像-容器概念"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#仓库-镜像-容器概念","aria-hidden":"true"}},[s._v("#")]),s._v(" 仓库/镜像/容器概念")]),s._v(" "),e("ul",[e("li",[e("code",[s._v("image")]),s._v("文件生成的容器实例，本身也是一个文件，称为镜像文件")]),s._v(" "),e("li",[s._v("一个容器运行一种服务，当我们需要的时候，就可以通过"),e("code",[s._v("Docker")]),s._v("客户端创建一个对应的运行实例，也就是我们的容器。")]),s._v(" "),e("li",[s._v("仓库就是放了一堆镜像的地方，我们可以把镜像发布到仓库种，需要的时候从仓库中拉下来就可以了。")])]),s._v(" "),e("h2",{attrs:{id:"docker安装并设置镜像加速"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker安装并设置镜像加速","aria-hidden":"true"}},[s._v("#")]),s._v(" Docker安装并设置镜像加速")]),s._v(" "),e("h3",{attrs:{id:"下载rpm包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#下载rpm包","aria-hidden":"true"}},[s._v("#")]),s._v(" "),e("strong",[s._v("下载rpm包")])]),s._v(" "),e("p",[e("strong",[s._v("首先，我们打开链接：")]),s._v(" "),e("a",{attrs:{href:"https://download.docker.com/linux/centos/7/x86_64/stable/Packages/",target:"_blank",rel:"noopener noreferrer"}},[s._v("点击这里"),e("OutboundLink")],1)]),s._v(" "),e("p",[e("strong",[s._v("下载以下2个rpm包")])]),s._v(" "),e("p",[e("code",[s._v("docker-ce-17.03.0.ce-1.el7.centos.x86_64.rpm")])]),s._v(" "),e("p",[e("code",[s._v("docker-ce-selinux-17.03.0.ce-1.el7.centos.noarch.rpm")])]),s._v(" "),e("h3",{attrs:{id:"安装防火墙"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装防火墙","aria-hidden":"true"}},[s._v("#")]),s._v(" "),e("strong",[s._v("安装防火墙")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" iptables-services\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("启动防火墙")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl start iptables\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("设为开机自启")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" iptables\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("清空默认规则")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("iptables -F\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("保存默认规则")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" iptables save\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"更新软件包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#更新软件包","aria-hidden":"true"}},[s._v("#")]),s._v(" 更新软件包")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum update\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("重启")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"安装rpm包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装rpm包","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装rpm包")]),s._v(" "),e("p",[e("strong",[s._v("在root目录下新建docker文件夹，把下载的两个文件放到文件夹里。")])]),s._v(" "),e("p",[e("strong",[s._v("安装rpm包")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("yum -y "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" *\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("验证是否安装成功")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl start docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("查看运行状态")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl status docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("查看是否能正常运行")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("docker run hello-world\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v('如果看到 "Hello from Docker!"说明docker安装成功。')])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/1/16c4b00169f7aeb2?w=787&h=418&f=png&s=29448",alt:""}})]),s._v(" "),e("blockquote",[e("p",[s._v("如果执行 "),e("code",[s._v("docker run hello-world")]),s._v(" 的时候报"),e("code",[s._v("docker: Error response from daemon: Get https://registry-1.docker.io/v2/XXX")]),s._v("，请先执行底下的步骤设置加速，最后执行该命令即可解决。")])]),s._v(" "),e("h3",{attrs:{id:"docker-镜像仓库加速配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#docker-镜像仓库加速配置","aria-hidden":"true"}},[s._v("#")]),s._v(" "),e("strong",[s._v("Docker 镜像仓库加速配置")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /lib/systemd/system/docker.service  /etc/systemd/system/docker.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("给权限")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" a+x /etc/systemd/system/docker.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("打开管理脚本")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/systemd/system/docker.service\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("在 ExecStart=/usr/bin/dockerd 后加上下面这句")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("--registry-mirror"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://kfp63jaj.mirror.aliyuncs.com\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("blockquote",[e("p",[s._v("其中"),e("code",[s._v("https://kfp63jaj.mirror.aliyuncs.com")]),s._v("，这个地址大家可以去"),e("a",{attrs:{href:"https://dev.aliyun.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云Docker官网"),e("OutboundLink")],1),s._v("获取。也可以使用上面的地址，因为是免费的嘛。")])]),s._v(" "),e("p",[e("strong",[s._v("获取加速镜像地址（可选）")])]),s._v(" "),e("p",[s._v("控制台找到容器镜像服务，然后在镜像中心下的镜像加速器得到加速地址。")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/1/16c4b0031c1baeb8?w=938&h=885&f=png&s=169217",alt:""}})]),s._v(" "),e("p",[e("strong",[s._v("接下来重载管理脚本")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl daemon-reload\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("重启docker")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("systemctl restart docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("查看进程")])]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -ef"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" docker\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[e("strong",[s._v("如何看到刚才链接的这句话，说明加速成功。")])]),s._v(" "),e("p",[e("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2019/8/1/16c4b0017238276c?w=764&h=192&f=png&s=16835",alt:""}})])])},[],!1,null,null,null);a.default=t.exports}}]);